<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval'  child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval'  child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>海龟汤内容生成器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 16px;
        }
        
        .role-selection {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .role-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            text-align: center;
        }
        
        .role-tabs {
            display: flex;
            background: #e9ecef;
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 15px;
        }
        
        .role-tab {
            flex: 1;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-weight: 500;
            color: #666;
        }
        
        .role-tab.active {
            background: #667eea;
            color: white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }
        
        .role-description {
            text-align: center;
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .form-content {
            padding: 30px 20px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        select, input, textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }
        
        select:focus, input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .checkbox-section {
            margin-bottom: 25px;
        }
        
        .checkbox-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 12px;
            max-height: 240px;
            overflow-y: auto;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: white;
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
        }
        
        .checkbox-item:hover {
            border-color: #667eea;
            transform: translateY(-1px);
        }
        
        .checkbox-item.selected {
            border-color: #667eea;
            background: #e8f4ff;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
        }
        
        .checkbox-item input[type="checkbox"] {
            width: auto;
            height: auto;
            margin: 0 8px 0 0;
            padding: 0;
            accent-color: #667eea;
        }
        
        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            font-weight: normal;
            font-size: 13px;
            color: #333;
        }
        
        .selected-display {
            margin-top: 12px;
            padding: 12px;
            background: #e8f4ff;
            border-radius: 8px;
            border: 1px solid #667eea;
            min-height: 20px;
        }
        
        .tag {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 10px;
            margin: 2px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .description {
            background: #f0f8ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 10px;
            margin-top: 8px;
            font-size: 13px;
            color: #0066cc;
            line-height: 1.4;
        }
        
        .clear-btn {
            background: #dc3545;
            color: white;
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .clear-btn:hover {
            background: #c82333;
            transform: translateY(-1px);
        }
        
        .generate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 18px 30px;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin: 30px 0 20px 0;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .generate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .random-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8787 100%);
            color: white;
            padding: 14px 24px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            justify-content: center;
        }

        .random-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .random-btn:active {
            transform: translateY(0);
        }
        
        .output {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 16px;
        }
        
        .output-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .role-indicator {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .copy-btn {
            background: #28a745;
            color: white;
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .copy-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .prompt-content {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 24px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            color: #333;
            white-space: pre-wrap;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .hidden {
            display: none;
        }

        /* 参数显示开关样式 */
        .switch-container {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f0f8ff;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #b3d9ff;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #667eea;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .switch-label {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }
        
        /* 移动端适配 */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .form-content {
                padding: 20px 15px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                margin-bottom: 20px;
            }
            
            .form-group {
                margin-bottom: 20px;
            }
            
            .checkbox-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 6px;
                padding: 12px;
                max-height: 200px;
            }
            
            .checkbox-item {
                padding: 6px 8px;
                font-size: 12px;
            }
            
            .role-tabs {
                flex-direction: column;
                gap: 4px;
            }
            
            .role-tab {
                padding: 10px 16px;
                font-size: 14px;
            }
            
            .generate-btn {
                padding: 16px 24px;
                font-size: 16px;
            }
            
            .output {
                margin-top: 20px;
                padding: 15px;
            }
            
            .prompt-content {
                padding: 16px;
                font-size: 13px;
                max-height: 400px;
            }
        }
        
        @media (max-width: 480px) {
            .checkbox-grid {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            }
            
            .checkbox-item {
                font-size: 11px;
                padding: 4px 6px;
            }
            
            .tag {
                font-size: 11px;
                padding: 3px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🐢 海龟汤内容生成器</h1>
            <p>专业级海龟汤创作工具，生成高质量逻辑严密的推理谜题</p>
        </div>
        
        <div class="role-selection">
            <div class="role-title">选择你的角色</div>
            <div class="role-tabs">
                <div class="role-tab active" data-role="player">
                    <div>🧩 我是玩家</div>
                </div>
                <div class="role-tab" data-role="host">
                    <div>🎪 我是主持人</div>
                </div>
            </div>
            <div class="role-description" id="role-description">
                我想要挑战海龟汤谜题，只需要汤面内容进行推理
            </div>
        </div>
        
        <div class="form-content">
            <form id="promptForm">
                <!-- 随机模式按钮 -->
                <button type="button" class="random-btn" onclick="randomizeForm()">
                    🎲 随机生成参数
                </button>

                <!-- 参数显示开关 -->
                <div class="switch-container">
                    <label class="switch">
                        <input type="checkbox" id="explainParams" checked="">
                        <span class="slider"></span>
                    </label>
                    <span class="switch-label">在提示词中解释参数含义（让AI更好理解创作要求）</span>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="type">谜题类型</label>
                        <select id="type" required="" onchange="showDescription('type')">
                            <option value="">请选择类型</option>
                            <option value="经典推理">经典推理</option>
                            <option value="心理悬疑">心理悬疑</option>
                            <option value="科幻奇幻">科幻奇幻</option>
                            <option value="日常生活">日常生活</option>
                            <option value="历史人文">历史人文</option>
                            <option value="恐怖惊悚">恐怖惊悚</option>
                            <option value="爱情情感">爱情情感</option>
                            <option value="职场商业">职场商业</option>
                            <option value="家庭伦理">家庭伦理</option>
                            <option value="青春校园">青春校园</option>
                            <option value="武侠江湖">武侠江湖</option>
                            <option value="都市奇谭">都市奇谭</option>
                        </select>
                        <div id="type-desc" class="description hidden"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="difficulty">难度等级</label>
                        <select id="difficulty" required="" onchange="showDescription('difficulty')">
                            <option value="">请选择难度</option>
                            <option value="新手村">新手村</option>
                            <option value="入门级">入门级</option>
                            <option value="进阶级">进阶级</option>
                            <option value="高手级">高手级</option>
                            <option value="大师级">大师级</option>
                            <option value="传说级">传说级</option>
                            <option value="地狱级">地狱级</option>
                        </select>
                        <div id="difficulty-desc" class="description hidden"></div>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="setting">故事背景</label>
                        <select id="setting" required="" onchange="showDescription('setting')">
                            <option value="">请选择背景</option>
                            <option value="现代都市">现代都市</option>
                            <option value="古代历史">古代历史</option>
                            <option value="未来科幻">未来科幻</option>
                            <option value="乡村田园">乡村田园</option>
                            <option value="海岛孤岛">海岛孤岛</option>
                            <option value="医院学校">医院学校</option>
                            <option value="密室封闭">密室封闭</option>
                            <option value="野外探险">野外探险</option>
                            <option value="豪宅别墅">豪宅别墅</option>
                            <option value="地下世界">地下世界</option>
                            <option value="虚拟网络">虚拟网络</option>
                            <option value="异次元空间">异次元空间</option>
                        </select>
                        <div id="setting-desc" class="description hidden"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="characters">人物设定</label>
                        <select id="characters" required="" onchange="showDescription('characters')">
                            <option value="">请选择人物</option>
                            <option value="单一主角">单一主角</option>
                            <option value="双人关系">双人关系</option>
                            <option value="家庭成员">家庭成员</option>
                            <option value="同事朋友">同事朋友</option>
                            <option value="陌生人群">陌生人群</option>
                            <option value="专业人士">专业人士</option>
                            <option value="特殊身份">特殊身份</option>
                            <option value="师生关系">师生关系</option>
                            <option value="上下级">上下级</option>
                            <option value="邻里关系">邻里关系</option>
                            <option value="网友关系">网友关系</option>
                        </select>
                        <div id="characters-desc" class="description hidden"></div>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="twist">反转类型</label>
                        <select id="twist" required="" onchange="showDescription('twist')">
                            <option value="">请选择反转</option>
                            <option value="身份反转">身份反转</option>
                            <option value="时间反转">时间反转</option>
                            <option value="空间反转">空间反转</option>
                            <option value="动机反转">动机反转</option>
                            <option value="因果反转">因果反转</option>
                            <option value="认知反转">认知反转</option>
                            <option value="双重反转">双重反转</option>
                            <option value="记忆反转">记忆反转</option>
                            <option value="生死反转">生死反转</option>
                            <option value="真假反转">真假反转</option>
                            <option value="梦境反转">梦境反转</option>
                        </select>
                        <div id="twist-desc" class="description hidden"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="style">叙述风格</label>
                        <select id="style" required="" onchange="showDescription('style')">
                            <option value="">请选择风格</option>
                            <option value="简洁明快">简洁明快</option>
                            <option value="细腻描述">细腻描述</option>
                            <option value="悬疑紧张">悬疑紧张</option>
                            <option value="幽默诙谐">幽默诙谐</option>
                            <option value="诗意抒情">诗意抒情</option>
                            <option value="冷峻客观">冷峻客观</option>
                            <option value="温馨治愈">温馨治愈</option>
                            <option value="黑色幽默">黑色幽默</option>
                            <option value="古典优雅">古典优雅</option>
                        </select>
                        <div id="style-desc" class="description hidden"></div>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="audience">目标受众</label>
                        <select id="audience" required="" onchange="showDescription('audience')">
                            <option value="">请选择受众</option>
                            <option value="儿童友好">儿童友好（6-12岁）</option>
                            <option value="青少年">青少年（13-18岁）</option>
                            <option value="年轻成人">年轻成人（19-30岁）</option>
                            <option value="职场人士">职场人士（25-40岁）</option>
                            <option value="中年群体">中年群体（35-55岁）</option>
                            <option value="银发一族">银发一族（55岁以上）</option>
                            <option value="全年龄向">全年龄向</option>
                            <option value="专业玩家">专业玩家</option>
                            <option value="文艺青年">文艺青年</option>
                            <option value="逻辑控">逻辑控</option>
                        </select>
                        <div id="audience-desc" class="description hidden"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="length">故事长度</label>
                        <select id="length" required="" onchange="showDescription('length')">
                            <option value="">请选择长度</option>
                            <option value="微型">微型（100字内）</option>
                            <option value="短篇">短篇（100-300字）</option>
                            <option value="中篇">中篇（300-600字）</option>
                            <option value="长篇">长篇（600-1000字）</option>
                            <option value="史诗">史诗（1000字以上）</option>
                        </select>
                        <div id="length-desc" class="description hidden"></div>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="logic-level">逻辑严密度</label>
                        <select id="logic-level" onchange="showDescription('logic-level')">
                            <option value="standard">标准</option>
                            <option value="strict">严格</option>
                            <option value="hardcore">极致严谨</option>
                        </select>
                        <div id="logic-level-desc" class="description hidden"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="creativity">创意程度</label>
                        <select id="creativity" onchange="showDescription('creativity')">
                            <option value="conservative">保守经典</option>
                            <option value="balanced">平衡创新</option>
                            <option value="innovative">大胆创新</option>
                        </select>
                        <div id="creativity-desc" class="description hidden"></div>
                    </div>
                </div>
                
                <div class="checkbox-section">
                    <div class="checkbox-header">
                        <label>核心主题（多选）</label>
                        <button type="button" class="clear-btn" onclick="clearAllSelections('themes')">清空</button>
                    </div>
                    <div class="checkbox-grid" id="themes-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-friendship" value="友情" onchange="updateSelection('themes', this)">
                            <label for="theme-friendship">友情</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-love" value="爱情" onchange="updateSelection('themes', this)">
                            <label for="theme-love">爱情</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-family" value="亲情" onchange="updateSelection('themes', this)">
                            <label for="theme-family">亲情</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-betrayal" value="背叛" onchange="updateSelection('themes', this)">
                            <label for="theme-betrayal">背叛</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-redemption" value="救赎" onchange="updateSelection('themes', this)">
                            <label for="theme-redemption">救赎</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-growth" value="成长" onchange="updateSelection('themes', this)">
                            <label for="theme-growth">成长</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-choice" value="选择" onchange="updateSelection('themes', this)">
                            <label for="theme-choice">选择</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-sacrifice" value="牺牲" onchange="updateSelection('themes', this)">
                            <label for="theme-sacrifice">牺牲</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-truth" value="真相" onchange="updateSelection('themes', this)">
                            <label for="theme-truth">真相</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-justice" value="正义" onchange="updateSelection('themes', this)">
                            <label for="theme-justice">正义</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-freedom" value="自由" onchange="updateSelection('themes', this)">
                            <label for="theme-freedom">自由</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-responsibility" value="责任" onchange="updateSelection('themes', this)">
                            <label for="theme-responsibility">责任</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-forgiveness" value="宽恕" onchange="updateSelection('themes', this)">
                            <label for="theme-forgiveness">宽恕</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-hope" value="希望" onchange="updateSelection('themes', this)">
                            <label for="theme-hope">希望</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-revenge" value="复仇" onchange="updateSelection('themes', this)">
                            <label for="theme-revenge">复仇</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-memory" value="记忆" onchange="updateSelection('themes', this)">
                            <label for="theme-memory">记忆</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-time" value="时间" onchange="updateSelection('themes', this)">
                            <label for="theme-time">时间</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-death" value="生死" onchange="updateSelection('themes', this)">
                            <label for="theme-death">生死</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-identity" value="身份" onchange="updateSelection('themes', this)">
                            <label for="theme-identity">身份</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-dream" value="梦想" onchange="updateSelection('themes', this)">
                            <label for="theme-dream">梦想</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-loneliness" value="孤独" onchange="updateSelection('themes', this)">
                            <label for="theme-loneliness">孤独</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-courage" value="勇气" onchange="updateSelection('themes', this)">
                            <label for="theme-courage">勇气</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-secret" value="秘密" onchange="updateSelection('themes', this)">
                            <label for="theme-secret">秘密</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="theme-fate" value="命运" onchange="updateSelection('themes', this)">
                            <label for="theme-fate">命运</label>
                        </div>
                    </div>
                    <div class="selected-display" id="themes-display">
                        <span style="color: #666;">请选择1-3个核心主题</span>
                    </div>
                </div>
                
                <div class="checkbox-section">
                    <div class="checkbox-header">
                        <label>情节元素（可选）</label>
                        <button type="button" class="clear-btn" onclick="clearAllSelections('elements')">清空</button>
                    </div>
                    <div class="checkbox-grid" id="elements-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-letter" value="信件" onchange="updateSelection('elements', this)">
                            <label for="element-letter">信件</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-photo" value="照片" onchange="updateSelection('elements', this)">
                            <label for="element-photo">照片</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-key" value="钥匙" onchange="updateSelection('elements', this)">
                            <label for="element-key">钥匙</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-phone" value="电话" onchange="updateSelection('elements', this)">
                            <label for="element-phone">电话</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-mirror" value="镜子" onchange="updateSelection('elements', this)">
                            <label for="element-mirror">镜子</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-window" value="窗户" onchange="updateSelection('elements', this)">
                            <label for="element-window">窗户</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-clock" value="钟表" onchange="updateSelection('elements', this)">
                            <label for="element-clock">钟表</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-book" value="书籍" onchange="updateSelection('elements', this)">
                            <label for="element-book">书籍</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-music" value="音乐" onchange="updateSelection('elements', this)">
                            <label for="element-music">音乐</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-flower" value="花朵" onchange="updateSelection('elements', this)">
                            <label for="element-flower">花朵</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-weather" value="天气" onchange="updateSelection('elements', this)">
                            <label for="element-weather">天气</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-food" value="食物" onchange="updateSelection('elements', this)">
                            <label for="element-food">食物</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-animal" value="动物" onchange="updateSelection('elements', this)">
                            <label for="element-animal">动物</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-car" value="车辆" onchange="updateSelection('elements', this)">
                            <label for="element-car">车辆</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-money" value="金钱" onchange="updateSelection('elements', this)">
                            <label for="element-money">金钱</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-jewelry" value="首饰" onchange="updateSelection('elements', this)">
                            <label for="element-jewelry">首饰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-medicine" value="药品" onchange="updateSelection('elements', this)">
                            <label for="element-medicine">药品</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-document" value="文件" onchange="updateSelection('elements', this)">
                            <label for="element-document">文件</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-tool" value="工具" onchange="updateSelection('elements', this)">
                            <label for="element-tool">工具</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="element-light" value="光线" onchange="updateSelection('elements', this)">
                            <label for="element-light">光线</label>
                        </div>
                    </div>
                    <div class="selected-display" id="elements-display">
                        <span style="color: #666;">可选择0-5个情节元素</span>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="custom-elements">自定义元素</label>
                        <input type="text" id="custom-elements" placeholder="自定义关键元素，用逗号分隔">
                    </div>
                    
                    <div class="form-group">
                        <label for="emotion">情感基调</label>
                        <select id="emotion" onchange="showDescription('emotion')">
                            <option value="">请选择基调</option>
                            <option value="温馨感人">温馨感人</option>
                            <option value="紧张刺激">紧张刺激</option>
                            <option value="悲伤沉重">悲伤沉重</option>
                            <option value="轻松愉快">轻松愉快</option>
                            <option value="神秘诡异">神秘诡异</option>
                            <option value="励志向上">励志向上</option>
                            <option value="浪漫唯美">浪漫唯美</option>
                            <option value="深沉思辨">深沉思辨</option>
                        </select>
                        <div id="emotion-desc" class="description hidden"></div>
                    </div>
                </div>
                
                <div class="form-group full-width">
                    <label for="special">特殊要求</label>
                    <textarea id="special" placeholder="例如：需要包含教育意义、避免暴力内容、融入科学知识、体现传统文化、必须有反转、不能有悲剧结局等"></textarea>
                </div>
                
                <button type="submit" class="generate-btn" id="generateBtn">🧩 生成汤面挑战</button>
            </form>
        </div>
        
        <div id="output" class="output hidden">
            <div class="output-header">
                <div class="role-indicator" id="role-badge">玩家模式</div>
                <button class="copy-btn" onclick="copyContent()">📋 复制内容</button>
            </div>
            <div class="prompt-content" id="prompt-content"></div>
        </div>
    </div>

    <script>
        const descriptions = {
            type: {
                '经典推理': {
                    display: '逻辑推理为核心',
                    criteria: '注重逻辑推理和线索分析。需要细致观察和严密推断。适合喜欢烧脑思考的玩家。重视因果关系和证据链条。'
                },
                '心理悬疑': {
                    display: '探索内心世界',
                    criteria: '探索人物内心世界和复杂动机。涉及心理状态转变和隐藏真相。需要理解人性和心理活动。关注情感动因。'
                },
                '科幻奇幻': {
                    display: '超现实元素',
                    criteria: '融入科学幻想或奇幻元素。可能涉及时空穿越、超能力或魔法。需要想象力和创造性思维。允许非现实设定。'
                },
                '日常生活': {
                    display: '平凡中的不凡',
                    criteria: '取材于日常场景，隐藏不平凡秘密。贴近生活易于理解。重视生活细节和常识推理。适合所有年龄段。'
                },
                '历史人文': {
                    display: '历史文化背景',
                    criteria: '以历史事件或文化背景为依托。融入历史知识和人文思考。需要一定历史文化素养。注重时代特征。'
                },
                '恐怖惊悚': {
                    display: '营造紧张氛围',
                    criteria: '营造紧张恐怖氛围，重在推理非纯粹吓人。适合喜欢刺激的玩家。可能涉及超自然元素。注意心理承受力。'
                },
                '爱情情感': {
                    display: '情感关系核心',
                    criteria: '以情感关系为核心。探讨爱情亲情友情等复杂情况。重视情感细节和心理描写。适合感性玩家。'
                },
                '职场商业': {
                    display: '职场环境背景',
                    criteria: '以工作环境为背景。涉及职场政治、商业竞争或行业内幕。需要理解职场规则。适合成年玩家。'
                },
                '家庭伦理': {
                    display: '家庭关系焦点',
                    criteria: '聚焦家庭内部关系。探讨代际冲突、伦理道德等深层话题。需要生活阅历。引发道德思考。'
                },
                '青春校园': {
                    display: '校园成长故事',
                    criteria: '以学校为背景。展现青春期成长烦恼和人际关系。贴近学生生活。注重青春期心理。'
                },
                '武侠江湖': {
                    display: '古风武侠世界',
                    criteria: '古风背景，涉及武林恩怨江湖义气。包含传统文化元素。允许武功设定。注重侠义精神。'
                },
                '都市奇谭': {
                    display: '都市超自然',
                    criteria: '现代都市中的超自然事件。现实与幻想交织。保持都市感的同时加入奇幻元素。适合想象力丰富者。'
                }
            },
            difficulty: {
                '新手村': {
                    display: '极简入门体验',
                    criteria: '1-2条直接线索，答案显而易见。1步推理即可得出答案。无误导信息。仅需日常生活常识。如：看到湿脚印→推出刚洗完澡'
                },
                '入门级': {
                    display: '基础推理训练',
                    criteria: '2-3条明显线索，需要简单组合。2步推理，因果关系清晰。最多1个弱误导，容易识破。基础常识即可。如：A说谎+B在场→B是真凶'
                },
                '进阶级': {
                    display: '标准推理挑战',
                    criteria: '3-4条线索，需要交叉验证。3-4步推理，包含1个关键转折。1-2个中等强度误导。可能涉及简单专业常识。如：时间矛盾+动机分析→隐藏真相'
                },
                '高手级': {
                    display: '复杂逻辑考验',
                    criteria: '4-5条线索，部分隐晦需挖掘。4-5步推理，含2个思维转折。2-3个强误导，包含假线索。需要一定专业知识辅助。如：多重身份+时间错位→真相反转'
                },
                '大师级': {
                    display: '高阶思维游戏',
                    criteria: '5-6条线索，多数需要深度解读。5-6步推理，包含多重反转。3-4个强误导，真假难辨。可能需要特定领域知识。如：心理暗示+逻辑陷阱→意外真相'
                },
                '传说级': {
                    display: '极限推理挑战',
                    criteria: '6条以上碎片化线索。6步以上推理，非线性思维。多个精心设计的陷阱。需要跨领域知识整合。如：需要完全重构故事框架才能发现真相'
                },
                '地狱级': {
                    display: '思维极限测试',
                    criteria: '所有信息都可能是线索或陷阱。需要颠覆性思维和元认知。整个表象可能都是误导。可能需要专业级知识或极强洞察力。如：答案违反直觉，需要哲学性思考'
                }
            },
            setting: {
                '现代都市': {
                    display: '繁华城市环境',
                    criteria: '现代化设施齐全，人际关系复杂。信息获取便利，科技元素丰富。适合涉及现代生活问题。注意都市特征。'
                },
                '古代历史': {
                    display: '历史时期背景',
                    criteria: '特定历史时期背景。需考虑社会制度、技术水平和文化特色。避免现代化思维。符合历史逻辑。'
                },
                '未来科幻': {
                    display: '高科技环境',
                    criteria: '高科技环境设定。可涉及人工智能、基因技术、太空探索。允许科幻设定。保持内在逻辑一致。'
                },
                '乡村田园': {
                    display: '宁静农村环境',
                    criteria: '宁静农村环境，人际关系相对简单。可能隐藏深层秘密。注重乡土气息。适合人情世故题材。'
                },
                '海岛孤岛': {
                    display: '封闭岛屿环境',
                    criteria: '相对封闭环境，人员有限。增加推理紧迫感和神秘感。资源限制明显。适合密室类推理。'
                },
                '医院学校': {
                    display: '专业机构环境',
                    criteria: '专业机构环境。涉及专业知识和特殊人际关系。有明确规则体系。适合职业相关谜题。'
                },
                '密室封闭': {
                    display: '封闭空间推理',
                    criteria: '封闭空间内推理。重点关注空间布局和物理限制。出入受限。适合不在场证明类。'
                },
                '野外探险': {
                    display: '自然环境故事',
                    criteria: '自然环境中的故事。可能涉及生存挑战和环境因素。注意自然规律。适合冒险题材。'
                },
                '豪宅别墅': {
                    display: '富豪阶层环境',
                    criteria: '富豪阶层生活环境。可能涉及财产继承、家族秘密。空间布局复杂。适合上流社会题材。'
                },
                '地下世界': {
                    display: '隐秘地下设施',
                    criteria: '隐秘的地下组织或设施。神秘危险的环境。信息不透明。适合阴谋论题材。'
                },
                '虚拟网络': {
                    display: '网络空间故事',
                    criteria: '网络空间中的故事。涉及数字化生活和虚拟现实。身份可能虚假。适合科技题材。'
                },
                '异次元空间': {
                    display: '超现实空间',
                    criteria: '超现实空间设定。可能有特殊物理法则。允许打破常规。需要想象力支撑。'
                }
            },
            length: {
                '微型': {
                    display: '极简风格',
                    criteria: '50-100字。极简风格，用最少文字表达最大信息量。每个字都要精心推敲。适合快速游戏。'
                },
                '短篇': {
                    display: '简洁明了',
                    criteria: '100-300字。简洁明了，适合快速阅读和推理。保留关键信息。平衡简洁与完整。'
                },
                '中篇': {
                    display: '平衡篇幅',
                    criteria: '300-600字。平衡的篇幅，有足够细节又不冗长。适合标准游戏时长。信息密度适中。'
                },
                '长篇': {
                    display: '丰富细节',
                    criteria: '600-1000字。丰富的细节描写，适合深度推理。可以包含更多线索。适合资深玩家。'
                },
                '史诗': {
                    display: '极致详细',
                    criteria: '1000字以上。极其详细的背景和人物刻画。信息量巨大。适合长时间游戏。'
                }
            },
            emotion: {
                '温馨感人': {
                    display: '温暖人心基调',
                    criteria: '温暖人心的故事基调。强调人性美好和情感纯真。结局偏向正面。适合治愈系玩家。'
                },
                '紧张刺激': {
                    display: '快节奏悬念',
                    criteria: '快节奏发展，充满悬念和紧迫感。保持高度紧张。适合寻求刺激的玩家。节奏紧凑。'
                },
                '悲伤沉重': {
                    display: '深沉情感表达',
                    criteria: '深沉的情感表达。可能涉及失去、遗憾等主题。引发情感共鸣。适合成熟玩家。'
                },
                '轻松愉快': {
                    display: '轻松娱乐氛围',
                    criteria: '轻松的氛围，适合娱乐和放松。避免沉重话题。保持愉悦感。适合休闲游戏。'
                },
                '神秘诡异': {
                    display: '营造神秘氛围',
                    criteria: '营造神秘氛围，增加故事吸引力。保持未知感。可能有超自然元素。适合好奇心强者。'
                },
                '励志向上': {
                    display: '积极正面价值',
                    criteria: '积极正面的价值观。给人以启发和动力。强调努力和希望。适合需要鼓励的玩家。'
                },
                '浪漫唯美': {
                    display: '诗意浪漫色彩',
                    criteria: '美好的爱情故事，充满诗意和浪漫。注重情感描写。营造唯美氛围。适合浪漫主义者。'
                },
                '深沉思辨': {
                    display: '哲学性思考',
                    criteria: '哲学性的思考。引发对人生社会的深度思考。可能没有标准答案。适合思辨型玩家。'
                }
            },
            characters: {
                '单一主角': {
                    display: '聚焦核心人物',
                    criteria: '故事围绕一个核心人物。重点分析其行为动机和心理。减少干扰因素。适合心理分析。'
                },
                '双人关系': {
                    display: '二人互动关系',
                    criteria: '两个主要人物的互动关系。如夫妻、朋友、敌人。关系动态是关键。适合关系推理。'
                },
                '家庭成员': {
                    display: '家庭关系网络',
                    criteria: '家庭内部关系网络。涉及血缘关系和家庭责任。情感纠葛复杂。适合伦理题材。'
                },
                '同事朋友': {
                    display: '平等关系群体',
                    criteria: '平等关系中的合作与竞争。友谊与利益的平衡。社交动态重要。适合职场题材。'
                },
                '陌生人群': {
                    display: '互不相识群体',
                    criteria: '互不相识的人因故聚集。增加不确定性。信任度低。适合悬疑题材。'
                },
                '专业人士': {
                    display: '特定专业背景',
                    criteria: '具有特定专业背景人物。可能涉及专业知识和职业操守。专业性是关键。适合行业题材。'
                },
                '特殊身份': {
                    display: '特殊社会地位',
                    criteria: '特殊社会地位或能力人物。如名人、罪犯、超能力者。身份是核心要素。适合奇幻题材。'
                },
                '师生关系': {
                    display: '教育环境关系',
                    criteria: '教育环境中的上下级关系。涉及知识传授和成长。有明确等级。适合成长题材。'
                },
                '上下级': {
                    display: '职场等级关系',
                    criteria: '职场中的等级关系。可能涉及权力和利益冲突。权力动态重要。适合职场题材。'
                },
                '邻里关系': {
                    display: '社区生活关系',
                    criteria: '社区生活中的人际关系。日常接触但不够深入。表面和谐可能有暗流。适合生活题材。'
                },
                '网友关系': {
                    display: '虚拟世界交往',
                    criteria: '虚拟世界中的交往。可能存在身份不确定性。真假难辨。适合网络题材。'
                }
            },
            twist: {
                '身份反转': {
                    display: '真假身份颠覆',
                    criteria: '人物真实身份与表面身份存在巨大差异。如卧底、伪装、替身。身份是核心谜底。需要重新理解所有行为。'
                },
                '时间反转': {
                    display: '时序误导颠倒',
                    criteria: '时间顺序的颠倒或时间跨度误导。可能涉及回忆、预见、时间循环。打破线性叙事。需要重构时间线。'
                },
                '空间反转': {
                    display: '地点空间误导',
                    criteria: '地点或空间关系的误导。如镜像空间、隐藏房间、虚假场景。空间是关键线索。需要重新理解布局。'
                },
                '动机反转': {
                    display: '善恶动机颠倒',
                    criteria: '人物行为的真实动机与表面完全不同。善恶颠倒，目的相反。需要重新评价人物。挑战道德判断。'
                },
                '因果反转': {
                    display: '原因结果颠倒',
                    criteria: '原因和结果的关系被颠倒。看似的结果实际是原因。逻辑链需要反向思考。挑战常规推理。'
                },
                '认知反转': {
                    display: '常识认知打破',
                    criteria: '打破常规认知和假设。挑战读者固有思维模式。需要跳出思维定式。可能违反直觉。'
                },
                '双重反转': {
                    display: '多层真相递进',
                    criteria: '包含两个以上的重大反转。层层递进的真相揭露。每次反转都颠覆前面认知。适合复杂剧情。'
                },
                '记忆反转': {
                    display: '记忆真假交错',
                    criteria: '涉及记忆的真假、遗忘或恢复。现实与回忆交错。记忆可能被篡改。需要辨别真假。'
                },
                '生死反转': {
                    display: '生死状态误判',
                    criteria: '关于生死状态的误判或隐瞒。可能涉及假死、失踪、灵魂。生死是核心谜题。情感冲击强。'
                },
                '真假反转': {
                    display: '虚实真假颠倒',
                    criteria: '真实与虚假的颠倒。可能涉及谎言、伪装或幻觉。需要辨别真相。考验判断力。'
                },
                '梦境反转': {
                    display: '现实梦境模糊',
                    criteria: '现实与梦境的界限模糊。可能整个故事都在梦中。需要质疑现实性。适合哲学思考。'
                }
            },
            style: {
                '简洁明快': {
                    display: '直击要点风格',
                    criteria: '语言简练，节奏明快。直击要点，避免冗余。每句话都有信息量。适合快节奏推理。'
                },
                '细腻描述': {
                    display: '丰富细节刻画',
                    criteria: '丰富的细节描写。营造深入的场景感和人物刻画。注重氛围营造。适合沉浸式体验。'
                },
                '悬疑紧张': {
                    display: '营造紧张悬念',
                    criteria: '营造紧张刺激的氛围。保持悬念和紧迫感。使用悬疑技巧。适合刺激体验。'
                },
                '幽默诙谐': {
                    display: '轻松幽默语调',
                    criteria: '轻松幽默的语调。在推理中融入趣味元素。缓解紧张氛围。适合娱乐向。'
                },
                '诗意抒情': {
                    display: '文学诗意表达',
                    criteria: '富有文学色彩的表达。情感丰富，意境深远。注重语言美感。适合文艺爱好者。'
                },
                '冷峻客观': {
                    display: '理性客观叙述',
                    criteria: '理性客观的叙述方式。重视事实和逻辑分析。避免情感色彩。适合纯推理。'
                },
                '温馨治愈': {
                    display: '温暖治愈表达',
                    criteria: '温暖人心的表达方式。给人以安慰和希望。传递正能量。适合情感需求。'
                },
                '黑色幽默': {
                    display: '讽刺幽默手法',
                    criteria: '以幽默方式表达严肃或悲伤主题。具有讽刺意味。需要理解深层含义。适合成熟玩家。'
                },
                '古典优雅': {
                    display: '文雅古典韵味',
                    criteria: '文雅的表达方式。具有古典文学韵味。用词考究。适合传统文化爱好者。'
                }
            },
            audience: {
                '儿童友好': {
                    display: '6-12岁儿童',
                    criteria: '内容健康向上，语言简单易懂。避免暴力恐怖元素。注重教育意义。保护儿童心理。'
                },
                '青少年': {
                    display: '13-18岁青少年',
                    criteria: '适合中学生理解水平。可涉及复杂情感和社会话题。避免过于成人化内容。注重价值引导。'
                },
                '年轻成人': {
                    display: '19-30岁成年人',
                    criteria: '内容相对成熟。可涉及职场、爱情等成人话题。推理难度适中。贴近年轻人生活。'
                },
                '职场人士': {
                    display: '25-40岁职场人',
                    criteria: '贴近工作生活。可能涉及职场压力、人际关系。理解职场规则。适合工作间隙游戏。'
                },
                '中年群体': {
                    display: '35-55岁中年人',
                    criteria: '贴近中年人生活经验。可能涉及家庭责任、事业发展。有人生阅历。理解生活复杂性。'
                },
                '银发一族': {
                    display: '55岁以上老年人',
                    criteria: '适合老年人生活节奏。可能涉及人生感悟、家庭和睦。语言平和。注重怀旧元素。'
                },
                '全年龄向': {
                    display: '老少皆宜',
                    criteria: '老少皆宜的内容。平衡各年龄段理解能力。避免极端元素。保持普适性。'
                },
                '专业玩家': {
                    display: '推理游戏高手',
                    criteria: '高难度推理挑战。不限制内容复杂度。追求推理极致体验。可以很烧脑。'
                },
                '文艺青年': {
                    display: '文学艺术爱好者',
                    criteria: '具有文学性和艺术性。注重精神层面思考。可以抽象深奥。适合思考人生。'
                },
                '逻辑控': {
                    display: '纯理性推理者',
                    criteria: '严密的逻辑结构。适合喜欢纯理性推理的玩家。排除情感干扰。追求逻辑完美。'
                }
            },
            'logic-level': {
                'standard': {
                    display: '基本逻辑合理',
                    criteria: '符合基本逻辑，不违背常识。适合大众娱乐。允许小瑕疵。重在趣味性。'
                },
                'strict': {
                    display: '逻辑严密无瑕',
                    criteria: '严格遵循逻辑规律。每个细节都经得起推敲。不允许逻辑漏洞。适合认真玩家。'
                },
                'hardcore': {
                    display: '极致逻辑严谨',
                    criteria: '极致的逻辑严密性。可能需要专业知识支撑。追求无懈可击。适合逻辑狂人。'
                }
            },
            creativity: {
                'conservative': {
                    display: '经典传统模式',
                    criteria: '使用经典的海龟汤结构和模式。稳妥可靠，容易理解。遵循传统套路。适合新手。'
                },
                'balanced': {
                    display: '传统创新平衡',
                    criteria: '在经典基础上适度创新。既熟悉又新鲜。保持可理解性。适合大多数玩家。'
                },
                'innovative': {
                    display: '大胆创新尝试',
                    criteria: '大胆尝试新的叙事手法和推理机制。挑战传统，可能难以理解。适合寻求新鲜感的玩家。'
                }
            }
        };

        let selectedData = {
            themes: [],
            elements: []
        };

        let selectedRole = 'player';

        // 角色选择
        document.querySelectorAll('.role-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const role = this.dataset.role;
                selectRole(role);
            });
        });

        function selectRole(role) {
            selectedRole = role;
            
            // 更新视觉反馈
            document.querySelectorAll('.role-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-role="${role}"]`).classList.add('active');
            
            // 更新描述
            const descriptions = {
                'player': '我想要挑战海龟汤谜题，只需要汤面内容进行推理',
                'host': '我要主持海龟汤游戏，需要完整的汤面、汤底和主持人手册'
            };
            document.getElementById('role-description').textContent = descriptions[role];
            
            // 更新按钮文字
            const btn = document.getElementById('generateBtn');
            if (role === 'player') {
                btn.innerHTML = '🧩 生成汤面挑战';
            } else {
                btn.innerHTML = '🎪 生成完整主持内容';
            }
        }

        function showDescription(selectId) {
            const select = document.getElementById(selectId);
            const descDiv = document.getElementById(selectId + '-desc');
            const value = select.value;
            
            if (value && descriptions[selectId] && descriptions[selectId][value]) {
                descDiv.textContent = descriptions[selectId][value].criteria;
                descDiv.classList.remove('hidden');
            } else {
                descDiv.classList.add('hidden');
            }
        }

        function updateSelection(type, checkbox) {
            const value = checkbox.value;
            const item = checkbox.closest('.checkbox-item');
            
            if (checkbox.checked) {
                if (!selectedData[type].includes(value)) {
                    selectedData[type].push(value);
                }
                item.classList.add('selected');
            } else {
                selectedData[type] = selectedData[type].filter(item => item !== value);
                item.classList.remove('selected');
            }
            
            updateDisplay(type);
        }

        function updateDisplay(type) {
            const display = document.getElementById(type + '-display');
            const items = selectedData[type];
            
            if (items.length === 0) {
                const placeholder = type === 'themes' ? '请选择1-3个核心主题' : '可选择0-5个情节元素';
                display.innerHTML = `<span style="color: #666;">${placeholder}</span>`;
            } else {
                const tags = items.map(item => `<span class="tag">${item}</span>`).join('');
                display.innerHTML = tags;
            }
        }

        function clearAllSelections(type) {
            selectedData[type] = [];
            document.querySelectorAll(`#${type}-group .checkbox-item`).forEach(item => {
                item.classList.remove('selected');
                item.querySelector('input[type="checkbox"]').checked = false;
            });
            updateDisplay(type);
        }

        // 随机生成功能
        function randomizeForm() {
            // 获取所有选项
            const selects = ['type', 'difficulty', 'setting', 'characters', 'twist', 'style', 'audience', 'length', 'emotion'];
            
            // 随机选择下拉菜单
            selects.forEach(id => {
                const select = document.getElementById(id);
                const options = Array.from(select.options).filter(opt => opt.value);
                if (options.length > 0) {
                    const randomIndex = Math.floor(Math.random() * options.length);
                    select.value = options[randomIndex].value;
                    showDescription(id);
                }
            });
            
            // 随机选择逻辑严密度和创意程度
            const logicSelect = document.getElementById('logic-level');
            const logicOptions = Array.from(logicSelect.options);
            logicSelect.value = logicOptions[Math.floor(Math.random() * logicOptions.length)].value;
            showDescription('logic-level');
            
            const creativitySelect = document.getElementById('creativity');
            const creativityOptions = Array.from(creativitySelect.options);
            creativitySelect.value = creativityOptions[Math.floor(Math.random() * creativityOptions.length)].value;
            showDescription('creativity');
            
            // 清空之前的选择
            clearAllSelections('themes');
            clearAllSelections('elements');
            
            // 随机选择1-3个主题
            const allThemes = Array.from(document.querySelectorAll('#themes-group input[type="checkbox"]'));
            const themeCount = Math.floor(Math.random() * 3) + 1; // 1-3个
            const shuffledThemes = allThemes.sort(() => Math.random() - 0.5);
            for (let i = 0; i < themeCount && i < shuffledThemes.length; i++) {
                shuffledThemes[i].checked = true;
                updateSelection('themes', shuffledThemes[i]);
            }
            
            // 随机选择0-5个元素
            const allElements = Array.from(document.querySelectorAll('#elements-group input[type="checkbox"]'));
            const elementCount = Math.floor(Math.random() * 6); // 0-5个
            const shuffledElements = allElements.sort(() => Math.random() - 0.5);
            for (let i = 0; i < elementCount && i < shuffledElements.length; i++) {
                shuffledElements[i].checked = true;
                updateSelection('elements', shuffledElements[i]);
            }
            
            // 清空自定义元素和特殊要求
            document.getElementById('custom-elements').value = '';
            document.getElementById('special').value = '';
            
            // 添加动画效果
            const button = event.target;
            button.style.transform = 'scale(0.95)';
            setTimeout(() => {
                button.style.transform = 'scale(1)';
            }, 200);
        }

        document.getElementById('promptForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (selectedData.themes.length === 0) {
                alert('请至少选择一个核心主题');
                return;
            }
            
            generateContent();
        });

        function generateContent() {
            const formData = {
                role: selectedRole,
                type: document.getElementById('type').value,
                difficulty: document.getElementById('difficulty').value,
                setting: document.getElementById('setting').value,
                characters: document.getElementById('characters').value,
                twist: document.getElementById('twist').value,
                style: document.getElementById('style').value,
                audience: document.getElementById('audience').value,
                length: document.getElementById('length').value,
                themes: selectedData.themes,
                elements: selectedData.elements,
                customElements: document.getElementById('custom-elements').value,
                emotion: document.getElementById('emotion').value,
                special: document.getElementById('special').value,
                logicLevel: document.getElementById('logic-level').value,
                creativity: document.getElementById('creativity').value
            };

            let prompt = '';
            
            if (selectedRole === 'player') {
                prompt = generatePlayerPrompt(formData);
                document.getElementById('role-badge').textContent = '玩家模式';
            } else {
                prompt = generateHostPrompt(formData);
                document.getElementById('role-badge').textContent = '主持人模式';
            }

            document.getElementById('prompt-content').textContent = prompt;
            document.getElementById('output').classList.remove('hidden');
            document.getElementById('output').scrollIntoView({ behavior: 'smooth' });
        }

        function getDifficultyDescription(difficulty) {
            const difficultyData = descriptions.difficulty[difficulty];
            return difficultyData ? difficultyData.display : '适中';
        }

        function getDifficultyFullDescription(difficulty) {
            const difficultyData = descriptions.difficulty[difficulty];
            return difficultyData ? difficultyData.criteria : '';
        }

        function getLogicDescription(level) {
            const logicData = descriptions['logic-level'][level];
            return logicData ? logicData.display : '标准';
        }

        function getCreativityDescription(level) {
            const creativityData = descriptions.creativity[level];
            return creativityData ? creativityData.display : '平衡创新';
        }

        function generatePlayerPrompt(data) {
            const explainParams = document.getElementById('explainParams').checked;
            const allElements = [...data.elements, ...(data.customElements ? data.customElements.split(',').map(s => s.trim()) : [])];
            
            let prompt = `请创作一个海龟汤谜题的汤面。海龟汤是一种情境推理游戏，玩家需要通过提问来揭开背后的真相。
核心要求：
- 谜题必须有内在逻辑连贯性，每个细节都有其存在的必然性
- 真相揭晓时要让人感到"原来如此"而非"牵强附会"
- 避免依赖巧合、文字游戏或低概率事件
- 确保因果链条清晰且符合现实逻辑
- 避免出现"空灵"或"空虚"的谜题
- 确保玩家能通过各种方式来理解并解释谜题的真相


创作要求：
- 类型：${data.type}
- 难度：${data.difficulty}
- 背景：${data.setting}
- 人物：${data.characters}
- 反转：${data.twist}
- 风格：${data.style}
- 受众：${data.audience}
- 长度：${data.length}（${getLengthRange(data.length)}）
- 主题：${data.themes.join('、')}
- 逻辑严密度：${getLogicDescription(data.logicLevel)}
- 创意程度：${getCreativityDescription(data.creativity)}`;

            if (allElements.length > 0) {
                prompt += `
- 关键元素：${allElements.join('、')}`;
            }

            if (data.emotion) {
                prompt += `
- 情感基调：${data.emotion}`;
            }

            if (data.special) {
                prompt += `
- 特殊要求：${data.special}`;
            }

            // 如果选择解释参数，则添加详细说明
            if (explainParams) {
                prompt += `

参数说明：
- ${data.type}：${descriptions.type[data.type].criteria}
- ${data.difficulty}：${descriptions.difficulty[data.difficulty].criteria}
- ${data.setting}：${descriptions.setting[data.setting].criteria}
- ${data.characters}：${descriptions.characters[data.characters].criteria}
- ${data.twist}：${descriptions.twist[data.twist].criteria}
- ${data.style}：${descriptions.style[data.style].criteria}
- ${getLogicDescription(data.logicLevel)}：${descriptions['logic-level'][data.logicLevel].criteria}
- ${getCreativityDescription(data.creativity)}：${descriptions.creativity[data.creativity].criteria}`;

                if (data.emotion) {
                    prompt += `
- ${data.emotion}：${descriptions.emotion[data.emotion].criteria}`;
                }
            }

            prompt += `

创作标准：
- 汤面必须呈现一个看似矛盾或不合理的情境
- 每个细节都要经得起逻辑推敲，不能有漏洞
- 描述要生动具体，能引发强烈的好奇心
- 结尾要留有悬念，让人想要探究真相
- 符合目标受众的理解能力和价值观
- 关键信息的隐藏要巧妙而非刻意
- 每个词语都经过推敲，既不误导也不泄露


请直接输出汤面内容，不要包含任何解释或说明。`;

            return prompt;
        }

        function generateHostPrompt(data) {
            const explainParams = document.getElementById('explainParams').checked;
            const allElements = [...data.elements, ...(data.customElements ? data.customElements.split(',').map(s => s.trim()) : [])];
            
            let prompt = `请为海龟汤游戏创作一套完整的主持材料。
核心要求：
- 谜题必须有内在逻辑连贯性，每个细节都有其存在的必然性
- 真相揭晓时要让人感到"原来如此"而非"牵强附会"
- 避免依赖巧合、文字游戏或低概率事件
- 确保因果链条清晰且符合现实逻辑
- 避免出现"空灵"或"空虚"的谜题
- 确保玩家能通过各种方式来理解并解释谜题的真相

创作要求：
- 类型：${data.type}
- 难度：${data.difficulty}
- 背景：${data.setting}
- 人物：${data.characters}
- 反转：${data.twist}
- 风格：${data.style}
- 受众：${data.audience}
- 长度：${data.length}（${getLengthRange(data.length)}）
- 主题：${data.themes.join('、')}
- 逻辑严密度：${getLogicDescription(data.logicLevel)}
- 创意程度：${getCreativityDescription(data.creativity)}`;

            if (allElements.length > 0) {
                prompt += `
- 关键元素：${allElements.join('、')}`;
            }

            if (data.emotion) {
                prompt += `
- 情感基调：${data.emotion}`;
            }

            if (data.special) {
                prompt += `
- 特殊要求：${data.special}`;
            }

            // 如果选择解释参数，则添加详细说明
            if (explainParams) {
                prompt += `

参数说明：
- ${data.type}：${descriptions.type[data.type].criteria}
- ${data.difficulty}：${descriptions.difficulty[data.difficulty].criteria}
- ${data.setting}：${descriptions.setting[data.setting].criteria}
- ${data.characters}：${descriptions.characters[data.characters].criteria}
- ${data.twist}：${descriptions.twist[data.twist].criteria}
- ${data.style}：${descriptions.style[data.style].criteria}
- ${data.audience}：${descriptions.audience[data.audience].criteria}
- ${getLogicDescription(data.logicLevel)}：${descriptions['logic-level'][data.logicLevel].criteria}
- ${getCreativityDescription(data.creativity)}：${descriptions.creativity[data.creativity].criteria}`;

                if (data.emotion) {
                    prompt += `
- ${data.emotion}：${descriptions.emotion[data.emotion].criteria}`;
                }
            }

            prompt += `

请按以下结构输出：

【汤面】
[一个看似矛盾的情境描述]

【汤底】
背景故事：[详细的事件背景和人物关系]
事件经过：[按时间顺序的完整事件描述]
真相揭秘：[解释所有矛盾和疑点的核心真相]
逻辑验证：[确认所有细节的合理性]

【主持指南】
开场建议：
- 游戏规则说明
- 氛围营造技巧

问答策略：
- 关键信息的回答原则
- 误导信息的处理方式
- 线索释放的节奏控制

常见问题：
- [列出5-10个玩家可能提出的关键问题及标准答案]

创作标准：
1. 汤面必须呈现一个看似矛盾或不合理的情境
2. 每个细节都要经得起逻辑推敲，不能有漏洞
3. 描述要生动具体，能引发强烈的好奇心
4. 结尾要留有悬念，让人想要探究真相
5. 符合目标受众的理解能力和价值观

注意事项：
- 避免过早暴露核心信息
- 保持逻辑一致性
- 根据玩家进度调整难度`;

            return prompt;
        }

        function getDifficultyQuestions(difficulty) {
            const questions = {
                '新手村': '3-5',
                '入门级': '5-8',
                '进阶级': '8-12',
                '高手级': '12-18',
                '大师级': '18-25',
                '传说级': '25-35',
                '地狱级': '35-50'
            };
            return questions[difficulty] || '10-15';
        }

        function getLengthRange(length) {
            const ranges = {
                '微型': '50-100字',
                '短篇': '100-300字',
                '中篇': '300-600字',
                '长篇': '600-1000字',
                '史诗': '1000字以上'
            };
            return ranges[length] || '适当篇幅';
        }

        function copyContent() {
            const content = document.getElementById('prompt-content').textContent;
            
            navigator.clipboard.writeText(content).then(function() {
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '✅ 已复制';
                button.style.background = '#007bff';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#28a745';
                }, 2000);
            }, function() {
                alert('复制失败，请手动复制');
            });
        }
    </script>



</body></html>
